{% extends 'base.html' %}
{% load staticfiles %}

{% block content %}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script type='text/javascript'>

	// function getCookie(name) {
	// 	var cookieValue = null;
	// 	if (document.cookie && document.cookie != '') {
	// 		var cookies = document.cookie.split(';');
	// 		for (var i = 0; i < cookies.length; i++) {
	// 			var cookie = jQuery.trim(cookies[i]);
 //                // Does this cookie string begin with the name we want?
 //                if (cookie.substring(0, name.length + 1) == (name + '=')) {
 //                	cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
 //                	break;
 //                }
 //            }
 //        }
 //        return cookieValue;
 //    }
 //    var csrftoken = getCookie('csrftoken');
 //    function csrfSafeMethod(method) {
 //        // these HTTP methods do not require CSRF protection
 //        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
 //    }

 //    function sameOrigin(url) {
 //        // test that a given url is a same-origin URL
 //        // url could be relative or scheme relative or absolute
 //        var host = document.location.host; // host + port
 //        var protocol = document.location.protocol;
 //        var sr_origin = '//' + host;
 //        var origin = protocol + sr_origin;
 //        // Allow absolute or scheme relative URLs to same origin
 //        return (url == origin || url.slice(0, origin.length + 1) == origin + '/') ||
 //        (url == sr_origin || url.slice(0, sr_origin.length + 1) == sr_origin + '/') ||
 //            // or any other URL that isn't scheme relative or absolute i.e relative.
 //            !(/^(\/\/|http:|https:).*/.test(url));
 //        }



 //        $.ajaxSetup({
 //        	beforeSend: function (xhr, settings) {
 //        		if (!csrfSafeMethod(settings.type) && sameOrigin(settings.url)) {
 //                // Send the token to same-origin, relative URLs only.
 //                // Send the token only if the method warrants CSRF protection
 //                // Using the CSRFToken value acquired earlier
 //                xhr.setRequestHeader("X-CSRFToken", csrftoken);
 //            }
 //        }
 //    });


 console.log(u);
 function c() {
 	console.log( document.getElementById('reply').value);

 	$.ajax({
 		url: '/reply_ajax/',
 		type: 'POST',
 		dataType: "json",
 		data: {
 			"value": document.getElementById('reply').value,
 			"csrfmiddlewaretoken" : '{{csrf_token}}'
 		},
 		success: function (data) {
 			console.log(data);
 			var li = document.createElement(li)
 			li.innerHTML = '<li class="comment"><div class="comment-body clearfix"><div class="avatar"><img alt="" src="../static/images/demo/avatar.png"></div><div class="comment-text"><div class="author clearfix"><div class="comment-author"><a href="#">'+data.name+'</a></div>			<div class="comment-meta"><div class="date"><i class="icon-time"></i>{{ c.created_date }}</div></div></div><div class="text"><p>'+data.value+'</p></div></div></div></li>';
 			document.getElementById('comment').appendChild(li)
 		}

 	});

 }
</script>

<div class="col-md-9">
	<div class="about-author clearfix">
		<div class="author-image">
			<a href="#" original-title="admin" class="tooltip-n"><img alt="" src="../ask-me/images/demo/admin.jpg"></a>
		</div>
		<div class="author-bio">
			<br>
			<h4>{{ question.author.username }}</h4>
		</div>
	</div><!-- End about-author -->
	<article class="question question-type-normal">
		<h2>
			<a href="/question_detail/{{ question.id }}">{{ question.question_title }}</a>
		</h2>
		<div class="question-author">
			<a href="#" original-title="ahmed" class="question-author-img tooltip-n"><span></span><img alt="" src="static/images/demo/avatar.png"></a>
		</div>
		<div class="question-inner">
			<div class="clearfix"></div>
			<p class="question-desc">{{ question.question_text }}</p>
			<div class="question-details">
				<span class="question-answered question-answered-done"><i class="icon-ok"></i>solved</span>
			</div>
			<span class="question-date"><i class="icon-time"></i>{{ question.created_date }}</span>
			<span class="question-comment"><a href="#"><i class="icon-comment"></i>{{ question.numAns }} Answers</a></span>
			<span class="question-view"><i class="icon-user"></i>{{question.numViews}} views</span>
			<div class="clearfix"></div>
		</div>
	</article>

	<div id="commentlist" class="page-content">
		<div class="boxedtitle page-title"><h2>Answers (<span class="color">{{ answers|length }}</span>)</h2></div>
		<ol class="commentlist clearfix">
			{% for ans in answers %}
			<li class="comment">
				<div class="comment-body comment-body-answered clearfix">
					<div class="avatar"><img alt="" src="{% static 'images/demo/admin.jpg'}"></div>
					<div class="comment-text">
						<div class="author clearfix">
							<div class="comment-author"><a href="#">{{ ans.author.username }}</a></div>
							<div class="comment-vote">
								<ul class="question-vote">
									<li><a href="/countUp/{{ question.id }}/{{ ans.id }}" class="question-vote-up" title="Like"></a></li>
									<li><a href="/countDown/{{ question.id }}/{{ ans.id }}" class="question-vote-down" title="Dislike"></a></li>
								</ul>
							</div>
							<span class="question-vote-result">{{ ans.avotes }}</span>
							<div class="comment-meta">
								<div class="date"><i class="icon-time"></i>{{ ans.created_date   }} - {{  question.created_date|timesince:ans.created_date   }}</div>
							</div>
						</div>
						<div class="text"><p>{{ ans.answer_text }}</p>
						</div>
					</div>
				</div>
				<!-- <h1>{{ comments|length }}</h1> -->
				{% for comment in comments %}
				{% if comment|length != 0 %}
				{% for c in comment %}
				{% if c.answer.id == ans.id %}
				<ul class="children" id = "comment">
					<li class="comment">
						<div class="comment-body clearfix">
							<div class="avatar"><img alt="" src="../static/images/demo/avatar.png"></div>
							<div class="comment-text">
								<div class="author clearfix">
									<div class="comment-author"><a href="#">{{ c.author.username }}</a></div>
									<div class="comment-meta">
										<div class="date"><i class="icon-time"></i>{{ c.created_date }}</div>
									</div>
								</div>
								<div class="text"><p>{{ c.comment_text }}</p>
								</div>
							</div>
						</div>
					</li>
				</ul>
				{% endif %}
				{% endfor %}
				{% endif%}
				{% endfor %}


				<div class="row" width="100%">
					<div class="col-md-5 col-md-offset-2">
						<input type="text" placeholder="Reply" name="comment" id="reply">
					</div>
					<div class="col-md-3">
						<p class="form-submit">
							<!-- <input name="{{ ans.id }}" type="submit" value="Submit" class="button small color"> -->
							<button onclick="c()">Submit</button> 
						</p>

					</div>








			                <!-- <div class="section-warp ask-me">
						        <div class="container clearfix">
						            <div class="box_icon box_warp box_no_border box_no_background" box_border="transparent" box_background="transparent" box_color="#FFF">
						                <div class="row">
						                    <div class="col-md-12">
								                <form class="form-style form-style-2">
						                            <p>
						                                <input type="text" id="question_title" value="Ask any question and you be sure find your answer ?" onfocus="if(this.value=='Ask any question and you be sure find your answer ?')this.value='';" onblur="if(this.value=='')this.value='Ask any question and you be sure find your answer ?';">
						                                <i class="icon-pencil"></i>
						                                <span class="color button small publish-question">Ask Now</span>
						                            </p>
						                        </form>
						                    </div>
						                </div>
						            </div>
						        </div>
						    </div> -->
						</li>
						{% endfor %}
					</ol><!-- End commentlist -->
				</div><!-- End page-content -->






				<div id="respond" class="comment-respond page-content clearfix">

					<div class="boxedtitle page-title"><h2>Post An Answer : </h2></div>
					<form action="#" method="post" id="commentform" class="comment-form">
						{% csrf_token %}
						<div id="respond-textarea">
							<p>
								<label class="required" for="comment">Your Answer<span>*</span></label>
								<textarea id="comment" name="answer" aria-required="true" cols="58" rows="8"></textarea>
							</p>
						</div>
						<p class="form-submit">
							<input name="answer-submit" type="submit" id="submit" value="Post your answer" class="button small color">
						</p>
					</form>
				</div>
				<br>
				<div id="related-posts">
					<h2>Related questions</h2>
					<ul class="related-posts">
						<li class="related-item"><h3><a href="#"><i class="icon-double-angle-right"></i>This Is My Second Poll Question</a></h3></li>
						<li class="related-item"><h3><a href="#"><i class="icon-double-angle-right"></i>This is my third Question</a></h3></li>
						<li class="related-item"><h3><a href="#"><i class="icon-double-angle-right"></i>This is my fourth Question</a></h3></li>
						<li class="related-item"><h3><a href="#"><i class="icon-double-angle-right"></i>This is my fifth Question</a></h3></li>
					</ul>
				</div><!-- End related-posts -->

			</div><!-- End main -->


			<script>

				function sendajax(){
					$.ajax({
						type: 'POST',
						url: '/reply_ajax/',
						dataType: "json",
						data: document.getElementById('reply').value,
						success: function (data) {
							console.log(data);
						}
						error: function() {
							alert('ajax error');
						}
					});
				}
			</script>


			{% endblock %}



<!--
'question':
	<Question: 1 - email@id.com>,
'user':
	<SimpleLazyObject: <User: admin>>,
'answers':
	<QuerySet [<Answer: email@id.com answered>,
				<Answer: abc@gmail.com answered>,
				<Answer: xyzabc@gmail.com answered>,
				<Answer: xyzabc3@gmail.com answered>,
				<Answer: abc@gmail.com answered>,
				<Answer: abc@gmail.com answered>,
				<Answer: abc@gmail.com answered>,
				<Answer: abc@gmail.com answered>]>,
'comments':
	[<QuerySet []>,
	<QuerySet [<Comment: xyzabc@gmail.com commented>,
	<Comment: xyzabc3@gmail.com commented>,
	<Comment: xyz@gmail.com commented>]>,
	<QuerySet []>,
	<QuerySet []>,
	<QuerySet []>,
	<QuerySet []>,
	<QuerySet []>,
	<QuerySet []>]
 -->